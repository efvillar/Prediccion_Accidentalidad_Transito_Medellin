plot_ly(x = ~SEMANA,
y = ~FREQ,
type = "scatter" ,mode = "lines",
split = ~ANO,
line=list(width=1))%>%
layout(title='Promedio semanal de ACCIDENTES en Medellin',
xaxis=list(title="SEMANA"),
yaxis=list(title="No. Accidentes"))
aggregate(FREQ~ANO*MES, data=Total_Dataset_Freq,FUN=mean)%>%
plot_ly(x = ~MES,
y = ~FREQ,
type = "scatter" ,mode = "lines",
split = ~ANO,
line=list(width=1))%>%
layout(title='Promedio mensual de ACCIDENTES en Medellin',
xaxis=list(title="Mes"),
yaxis=list(title="No. Accidentes"))
aggregate(FREQ~GRAVEDAD*MES, data=Total_Dataset_Freq,FUN=mean)%>%
plot_ly(x = ~MES,
y = ~FREQ,
type = "scatter" ,mode = "lines",
split = ~GRAVEDAD,
line=list(width=1))%>%
layout(title='Promedio mensual de ACCIDENTES en Medellin por GRAVEDAD',
xaxis=list(title="Mes"),
yaxis=list(title="No. Accidentes"))
library(plotly)
aggregate(FREQ~GRAVEDAD*FECHA, data=Total_Dataset_Freq,FUN=mean)%>%
plot_ly(x = ~FECHA,
y = ~FREQ,
type = "scatter" ,mode = "lines",
split = ~GRAVEDAD,
line=list(width=1))%>%
layout(title='Promedio diario ACCIDENTES en Medellin por GRAVEDAD',
xaxis=list(title="Mes"),
yaxis=list(title="No. Accidentes"))
aggregate(FREQ~ANO*DIA_NOMBRE, data=Total_Dataset_Freq,FUN=mean)%>%
plot_ly(x = ~DIA_NOMBRE,
y = ~FREQ,
type = "scatter" ,mode = "lines",
split = ~ANO,
line=list(width=1))%>%
layout(title='Promedio diario DIA DE LA SEMANA de Accidentes de Transito en Medellin',
xaxis=list(title="Dia Semana"),
yaxis=list(title="No. Accidentes"))
aggregate(FREQ~ANO*GRAVEDAD, data=Total_Dataset_Freq,FUN=mean)%>%
plot_ly(x = ~GRAVEDAD,
y = ~FREQ,
type = "scatter" ,mode = "lines",
split = ~ANO,
line=list(width=1))%>%
layout(title='Promedio diario CLASE de Accidentes de Transito en Medellin',
xaxis=list(title="Clase"),
yaxis=list(title="No. Accidentes"))
head(Total_Dataset_Freq)
library(reshape)
Total_Dataset_Freq <- cast(Total_Dataset_Freq[,c(1,2,3)],FECHA~GRAVEDAD)
Total_Dataset_Freq <- sqldf("SELECT *
FROM Total_Dataset_Freq
LEFT JOIN Dias_Especiales USING(FECHA)")
Total_Dataset_Freq$ANO <- as.factor(format(Total_Dataset_Freq$FECHA,'%Y'))
Total_Dataset_Freq$SEMANA <-as.factor(format(Total_Dataset_Freq$FECHA,'%V'))
Total_Dataset_Freq$DIA <-as.factor(format(Total_Dataset_Freq$FECHA,'%d'))
Total_Dataset_Freq$DIA_SEMANA <-as.factor(weekdays(Total_Dataset_Freq$FECHA))
Total_Dataset_Freq$MES <-as.factor(format(Total_Dataset_Freq$FECHA,'%m'))
head(Total_Dataset_Freq)
Total_Dataset_Freq[is.na(Total_Dataset_Freq)] <- 0
Total_Dataset_Freq$Total_Accidentes <- Total_Dataset_Freq$`SOLO DAÃâOS` + Total_Dataset_Freq$MUERTO + Total_Dataset_Freq$HERIDO
Total_Dataset_Freq$Accidentes_Leves <- + Total_Dataset_Freq$`SOLO DAÑOS`
Total_Dataset_Freq$Accidentes_Leves <- + Total_Dataset_Freq$`SOLO.DAÑOS`
View(Total_Dataset_Freq)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
raw_data_2014 <- read.csv(file="./data/Accidentalidad_georreferenciada_2014.csv", encoding="UTF-8", header=TRUE, sep=",")
raw_data_2014 <- read.csv(file="../data/Accidentalidad_georreferenciada_2014.csv", encoding="UTF-8", header=TRUE, sep=",")
raw_data_2014 <- read.csv(file="../data/Accidentalidad_georreferenciada_2014.csv", encoding="UTF-8", header=TRUE, sep=",")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
raw_data_2014 <- read.csv(file="../data/Accidentalidad_georreferenciada_2014.csv", encoding="UTF-8", header=TRUE, sep=",")
raw_data_2015 <- read.csv(file="../data/Accidentalidad_georreferenciada_2015.csv", encoding="UTF-8", header=TRUE, sep=",")
raw_data_2016 <- read.csv(file="../data/Accidentalidad_georreferenciada_2016.csv", encoding="UTF-8", header=TRUE, sep=",")
raw_data_2017 <- read.csv(file="../data/Accidentalidad_georreferenciada_2017.csv", encoding="UTF-8", header=TRUE, sep=",")
raw_data_2018 <- read.csv(file="../data/Accidentalidad_georreferenciada_2018.csv", encoding="UTF-8", header=TRUE, sep=",")
levels(raw_data_2018$CLASE)
levels(Total_Dataset$GRAVEDAD)
Total_Dataset <- rbind(raw_data_2014,raw_data_2015,raw_data_2016, raw_data_2017, raw_data_2018)
levels(Total_Dataset$GRAVEDAD)
str(Total_Dataset)
levels(Total_Dataset$GRAVEDAD) <- c("HERIDO","MUERTO","SOLO_DANOS")
levels(Total_Dataset$GRAVEDAD)
levels(Total_Dataset$GRAVEDAD)
summary(Total_Dataset$GRAVEDAD)
summary(Total_Dataset$GRAVEDAD)
levels(Total_Dataset$GRAVEDAD)
levels(Total_Dataset$GRAVEDAD) <- c("ACCIDENTES_GRAVES","ACCIDENTES_GRAVES","ACCIDENTES_LEVES")
levels(Total_Dataset$GRAVEDAD)
summary(Total_Dataset$GRAVEDAD)
rm(raw_data_2014,raw_data_2015,raw_data_2016, raw_data_2017, raw_data_2018)
Total_Dataset$FECHA <- as.Date(Total_Dataset$FECHA, format="%Y-%m-%d")
tail(Total_Dataset)
Total_Dataset$FECHA <- as.Date(Total_Dataset$FECHA, format="%Y-%m-%d")
tail(Total_Dataset$FECHA)
Total_Dataset$FECHA <- as.Date(Total_Dataset$FECHA, format="%Y-%m-%d")
tail(Total_Dataset)
Total_Dataset_v1 <- data.frame(Total_Dataset,5, c('FECHA'),)
Total_Dataset_v1 <- data.frame(Total_Dataset, c('FECHA'))
Total_Dataset_v1 <- data.frame(Total_Dataset,5, c('FECHA'))
View(Total_Dataset_v1)
View(Total_Dataset_v1)
Total_Dataset_v1 <- Total_Dataset[,c('FECHA')]
Total_Dataset_v1 <- Total_Dataset[,c('FECHA','DIA')]
View(Total_Dataset_v1)
Total_Dataset$FECHA <- as.Date(Total_Dataset$FECHA, format="%Y-%m-%d")
tail(Total_Dataset)
Total_Dataset_v1 <- Total_Dataset[,c('GRAVEDAD','FECHA','DIA','DIA_NOMBRE','MES')]
Total_Dataset_v1 <- Total_Dataset[,c('GRAVEDAD','FECHA','DIA','DIA_NOMBRE','MES')]
Total_Dataset_v1 <- Total_Dataset[,c('GRAVEDAD','FECHA','DIA','DIA_NOMBRE','MES')]
tail(Total_Dataset)
Total_Dataset <- Total_Dataset[,c('GRAVEDAD','FECHA','DIA','DIA_NOMBRE','MES')]
tail(Total_Dataset)
Total_Dataset$DIA <- as.factor(Total_Dataset$DIA)
Total_Dataset$MES <- as.factor(Total_Dataset$MES)
tail(Total_Dataset)
library(sqldf)
Total_Dataset_Freq <- sqldf("SELECT FECHA, GRAVEDAD, count(GRAVEDAD) AS FREQ, DIA_NOMBRE, MES, DIA
FROM Total_Dataset
GROUP BY FECHA, GRAVEDAD")
View(Total_Dataset_Freq)
Total_Dataset_Freq$ANO <- as.factor(format(Total_Dataset_Freq$FECHA,'%Y'))
Total_Dataset_Freq$SEMANA <-as.factor(format(Total_Dataset_Freq$FECHA,'%V'))
tail(Total_Dataset_Freq)
levels(Total_Dataset_Freq$DIA_NOMBRE)
levels(Total_Dataset_Freq$DIA_NOMBRE) <- c("DOMINGO","JUEVES","LUNES","MARTES","MIERCOLES","SABADO","VIERNES")
levels(Total_Dataset_Freq$DIA_NOMBRE) <- c("DOMINGO","JUEVES","LUNES","MARTES","MIERCOLES","SABADO","VIERNES")
levels(Total_Dataset_Freq$DIA_NOMBRE)
Total_Dataset_Freq$DIA_NOMBRE <- ordered(Total_Dataset_Freq$DIA_NOMBRE,c("LUNES", "MARTES", "MIERCOLES", "JUEVES", "VIERNES", "SABADO", "DOMINGO"))
levels(Total_Dataset_Freq$DIA_NOMBRE)
Dias_Especiales <- read.csv(file="../data/Caracterizacion_v2.csv", encoding="UTF-8", header=TRUE, sep=";",stringsAsFactors=FALSE)
View(Dias_Especiales)
Dias_Especiales <- read.csv(file="../data/Caracterizacion.csv", encoding="UTF-8", header=TRUE, sep=";",stringsAsFactors=FALSE)
head(Dias_Especiales)
Dias_Especiales <- Dias_Especiales[1:1826,]
Dias_Especiales$FECHA <- as.Date(Dias_Especiales$Fecha, format="%d-%m-%Y")
Dias_Especiales <- Dias_Especiales[1:1826,]
Dias_Especiales$FECHA <- as.Date(Dias_Especiales$Fecha, format="%d-%m-%Y")
head(Dias_Especiales)
Dias_Especiales <- Dias_Especiales[1:1826,]
Dias_Especiales$FECHA <- as.Date(Dias_Especiales$Fecha, format="%d-%m-%Y")
head(Dias_Especiales)
Dias_Especiales <- Dias_Especiales[1:1826,]
Dias_Especiales$Fecha <- as.Date(Dias_Especiales$Fecha, format="%d-%m-%Y")
head(Dias_Especiales)
Dias_Especiales$FECHA <- NULL
head(Dias_Especiales)
Total_Dataset_Freq <- sqldf("SELECT *
FROM Total_Dataset_Freq TDF
LEFT JOIN Dias_Especiales DE USING(TDF.FECHA=DE.Fecha)")
Total_Dataset_Freq <- sqldf("SELECT *
FROM Total_Dataset_Freq TDF
LEFT JOIN Dias_Especiales DE ON (TDF.FECHA=DE.Fecha)")
View(Total_Dataset_Freq)
Total_Dataset <- Total_Dataset[,c('GRAVEDAD','FECHA','DIA','DIA_NOMBRE','MES')]
tail(Total_Dataset)
View(Dias_Especiales)
head(Total_Dataset_Freq)
save(Total_Dataset_Freq,file="../data/Frecuencia_Accidentes.Rda")
knitr::opts_chunk$set(echo = TRUE)
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT ANO, MES, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados
FROM Dias_Especiales
GROUP BY ANO,MES")
View(Dias_Especiales)
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT Ano_Base, MES, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados
FROM Dias_Especiales
GROUP BY ANO,MES")
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT Ano_Base, Mes, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados
FROM Dias_Especiales
GROUP BY ANO,MES")
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT Ano_Base, Mes, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados
FROM Dias_Especiales
GROUP BY Ano_Base,Mes")
Dias_Especiales$ANO <- as.factor(format(Dias_Especiales$FECHA,'%Y'))
Dias_Especiales$SEMANA <-as.factor(format(Dias_Especiales$FECHA,'%V'))
Dias_Especiales$MES <-as.factor(format(Dias_Especiales$FECHA,'%m'))
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT Ano_Base, Mes, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados
FROM Dias_Especiales
GROUP BY Ano_Base, Mes")
View(Dias_Especiales_Mensuales)
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT ANO, MES, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados
FROM Dias_Especiales
GROUP BY ANO, MES")
View(Dias_Especiales)
head(Dias_Especiales)
Dias_Especiales$ANO <- as.factor(format(Dias_Especiales$FECHA,'%Y'))
head(Dias_Especiales)
Dias_Especiales$ANO <- as.factor(format(Dias_Especiales$Fecha,'%Y'))
Dias_Especiales$SEMANA <-as.factor(format(Dias_Especiales$Fecha,'%V'))
Dias_Especiales$MES <-as.factor(format(Dias_Especiales$Fecha,'%m'))
head(Dias_Especiales)
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT ANO, MES, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados
FROM Dias_Especiales
GROUP BY ANO, MES")
save(Total_Dataset_Freq,file="../data/Frecuencia_De_Accidentes_Diario.Rda")
Total_Dataset_Freq$MES <-as.factor(format(Total_Dataset_Freq$MES,'%m'))
Total_Dataset_Freq$MES <-as.factor(format(Total_Dataset_Freq$FECHA,'%m'))
tail(Total_Dataset_Freq)
HEAD(Total_Dataset_Freq)
head(Total_Dataset_Freq)
library(sqldf)
Total_Dataset_Freq_M <- sqldf("SELECT ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY ANO, MES, GRAVEDAD")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("SELECT ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY ANO, MES, GRAVEDAD")
View(Total_Dataset_Freq)
Total_Dataset_Freq$Fecha<- NULL
head(Total_Dataset_Freq)
library(sqldf)
Total_Dataset_Freq_M <- sqldf("SELECT ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY ANO, MES, GRAVEDAD")
View(Total_Dataset_Freq_M)
library(sqldf)
Total_Dataset_Freq_M <- sqldf("SELECT ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY ANO, MES, GRAVEDAD")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("SELECT TDF.ANO, TDF.MES, TDF.GRAVEDAD, sum(TDF.FREQ) as FREQ
FROM Total_Dataset_Freq TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY ANO, MES, GRAVEDAD")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("SELECT TDF.ANO, TDF.MES, TDF.GRAVEDAD, sum(TDF.FREQ) as FREQ
FROM Total_Dataset_Freq TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
View(Total_Dataset_Freq_M)
library(sqldf)
Total_Dataset_Freq_M <- sqldf("SELECT TDF.ANO, TDF.MES, TDF.GRAVEDAD, sum(TDF.FREQ) as FREQ
FROM Total_Dataset_Freq TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("SELECT*
FROM Total_Dataset_Freq TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
View(Total_Dataset_Freq_M)
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT*
FROM(
SELECT  TDF.ANO, TDF.MES, TDF.GRAVEDAD, sum(TDF.FREQ) as FREQ
FROM Total_Dataset_Freq) TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT*
FROM(
SELECT  ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq) TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
View(Total_Dataset_Freq_M)
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT*
FROM(
SELECT  ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP 1,2,3) TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT*
FROM(
SELECT  ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
View(Total_Dataset_Freq_M)
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT ANO, MES, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados, sum(Feriado_Lunes) AS Feriados_Lunes, sum(Feriado_Otro) AS Feriados_Otro
FROM Dias_Especiales
GROUP BY ANO, MES")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.MES, TDF.GRAVEDAD, TDF.FREQ, Freq_lunes, Freq_martes, Freq_miercoles, Freq_jueves,Freq_viernes, Freq_sabado, Freq_domingo, Feriados, Feriados_Lunes, Feriados_Otro
FROM
(
SELECT
ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT ANO, MES, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados, sum(Feriado_Lunes) AS Feriados_Lunes, sum(Feriado_Otro) AS Feriados_Otro
FROM Dias_Especiales
GROUP BY ANO, MES")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.MES, TDF.GRAVEDAD, TDF.FREQ, Freq_lunes, Freq_martes, Freq_miercoles, Freq_jueves,Freq_viernes, Freq_sabado, Freq_domingo, Feriados, Feriados_Lunes, Feriados_Otro
FROM
(
SELECT
ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
save(Total_Dataset_Freq_M,file="../data/Frecuencia_De_Accidentes_Mensual.Rda")
library(sqldf)
Dias_Especiales_Semanal <- sqldf("SELECT ANO, SEMANA, Feria_Flores_Semana,Semana_Santa_Semana, sum(Feriado_Lunes) as Feriados_Lunes, sum(Feriado_Otro) as Feriados_Otros
FROM Dias_Especiales
GROUP BY ANO,SEMANA,Feria_Flores_Semana,Semana_Santa_Semana")
View(Dias_Especiales_Semanal)
View(Dias_Especiales)
View(Total_Dataset_Freq)
View(Total_Dataset_v1)
library(sqldf)
Dias_Especiales_Semanal <- sqldf("SELECT ANO, SEMANA, Feria_Flores_Semana,Semana_Santa_Semana, sum(Feriado_Lunes) as Feriados_Lunes, sum(Feriado_Otro) as Feriados_Otros, count(ANO)
FROM Dias_Especiales
GROUP BY ANO,SEMANA,Feria_Flores_Semana,Semana_Santa_Semana")
library(sqldf)
Dias_Especiales_Semanal <- sqldf("SELECT ANO, SEMANA, Feria_Flores_Semana,Semana_Santa_Semana, sum(Feriado_Lunes) as Feriados_Lunes, sum(Feriado_Otro) as Feriados_Otros
FROM Dias_Especiales
GROUP BY ANO,SEMANA,Feria_Flores_Semana,Semana_Santa_Semana")
View(Dias_Especiales)
View(Total_Dataset_Freq)
View(Total_Dataset_Freq_M)
View(Dias_Especiales)
View(Dias_Especiales_Mensuales)
View(Dias_Especiales)
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.SEMANA, TDF.GRAVEDAD, TDF.FREQ, DES.Feria_Flores_Semana AS Feria_Flores, DES.Semana_Santa_Semana AS Semana_Santa, DES.Feriados_Lunes, DES.Feriados_Otros
FROM
(
SELECT
ANO, SEMANA, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Mensuales DES
ON (TDF.ANO=DES.ANO AND TDF.MES=DES.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.SEMANA, TDF.GRAVEDAD, TDF.FREQ, DES.Feria_Flores_Semana AS Feria_Flores, DES.Semana_Santa_Semana AS Semana_Santa, DES.Feriados_Lunes, DES.Feriados_Otros
FROM
(
SELECT
ANO, SEMANA, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Semana DES
ON (TDF.ANO=DES.ANO AND TDF.MES=DES.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.SEMANA, TDF.GRAVEDAD, TDF.FREQ, DES.Feria_Flores_Semana AS Feria_Flores, DES.Semana_Santa_Semana AS Semana_Santa, DES.Feriados_Lunes, DES.Feriados_Otros
FROM
(
SELECT
ANO, SEMANA, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Semanal DES
ON (TDF.ANO=DES.ANO AND TDF.MES=DES.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.SEMANA, TDF.GRAVEDAD, TDF.FREQ, DES.Feria_Flores_Semana AS Feria_Flores, DES.Semana_Santa_Semana AS Semana_Santa, DES.Feriados_Lunes, DES.Feriados_Otros
FROM
(
SELECT
ANO, SEMANA, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Semanal DES
ON (TDF.ANO=DES.ANO AND TDF.SEMANA=DES.SEMANA)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.SEMANA, TDF.GRAVEDAD, TDF.FREQ, DES.Feria_Flores_Semana AS Feria_Flores, DES.Semana_Santa_Semana AS Semana_Santa, DES.Feriados_Lunes, DES.Feriados_Otros
FROM
(
SELECT
ANO, SEMANA, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Semanal DES
ON (TDF.ANO=DES.ANO AND TDF.SEMANA=DES.SEMANA)
GROUP BY TDF.ANO, TDF.SEMANA, TDF.GRAVEDAD")
View(Total_Dataset_Freq_M)
save(Total_Dataset_Freq_M,file="../data/Frecuencia_De_Accidentes_Semanal.Rda")
View(Total_Dataset_Freq_M)
View(Dias_Especiales_Mensuales)
Dias_Especiales <- read.csv(file="../data/Caracterizacion_v2.csv", encoding="UTF-8", header=TRUE, sep=";",stringsAsFactors=FALSE)
head(Dias_Especiales)
View(Dias_Especiales)
Dias_Especiales$ANO <- as.factor(format(Dias_Especiales$Fecha,'%Y'))
Dias_Especiales <- Dias_Especiales[1:2922,]
Dias_Especiales$Fecha <- as.Date(Dias_Especiales$Fecha, format="%d-%m-%Y")
Dias_Especiales$ANO <- as.factor(format(Dias_Especiales$Fecha,'%Y'))
Dias_Especiales$SEMANA <-as.factor(format(Dias_Especiales$Fecha,'%V'))
Dias_Especiales$MES <-as.factor(format(Dias_Especiales$Fecha,'%m'))
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT ANO, MES, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados, sum(Feriado_Lunes) AS Feriados_Lunes, sum(Feriado_Otro) AS Feriados_Otro
FROM Dias_Especiales
GROUP BY ANO, MES")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.MES, TDF.GRAVEDAD, TDF.FREQ, Freq_lunes, Freq_martes, Freq_miercoles, Freq_jueves,Freq_viernes, Freq_sabado, Freq_domingo, Feriados, Feriados_Lunes, Feriados_Otro
FROM
(
SELECT
ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
save(Total_Dataset_Freq_M,file="../data/Frecuencia_De_Accidentes_Mensual.Rda")
library(sqldf)
Dias_Especiales_Semanal <- sqldf("SELECT ANO, SEMANA, Feria_Flores_Semana,Semana_Santa_Semana, sum(Feriado_Lunes) as Feriados_Lunes, sum(Feriado_Otro) as Feriados_Otros
FROM Dias_Especiales
GROUP BY ANO,SEMANA,Feria_Flores_Semana,Semana_Santa_Semana")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.SEMANA, TDF.GRAVEDAD, TDF.FREQ, DES.Feria_Flores_Semana AS Feria_Flores, DES.Semana_Santa_Semana AS Semana_Santa, DES.Feriados_Lunes, DES.Feriados_Otros
FROM
(
SELECT
ANO, SEMANA, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Semanal DES
ON (TDF.ANO=DES.ANO AND TDF.SEMANA=DES.SEMANA)
GROUP BY TDF.ANO, TDF.SEMANA, TDF.GRAVEDAD")
View(Total_Dataset_Freq_M)
Dias_Especiales <- read.csv(file="../data/Caracterizacion_v2.csv", encoding="UTF-8", header=TRUE, sep=";",stringsAsFactors=FALSE)
View(Dias_Especiales)
Dias_Especiales <- Dias_Especiales[1:2922,]
Dias_Especiales$Fecha <- as.Date(Dias_Especiales$Fecha, format="%d-%m-%Y")
Dias_Especiales$ANO <- as.factor(format(Dias_Especiales$Fecha,'%Y'))
Dias_Especiales$SEMANA <-as.factor(format(Dias_Especiales$Fecha,'%V'))
Dias_Especiales$MES <-as.factor(format(Dias_Especiales$Fecha,'%m'))
library(sqldf)
Dias_Especiales_Mensuales <- sqldf("SELECT ANO, MES, sum(Lunes)-4 AS Freq_lunes, sum(martes)-4 AS Freq_martes, sum(miercoles)-4 AS Freq_miercoles, sum(jueves)-4 AS Freq_jueves, sum(viernes)-4 AS Freq_viernes, sum(sabado)-4 AS Freq_sabado, sum(domingo)-4 AS Freq_domingo, sum(Feriado_Lunes+Feriado_Otro) as Feriados, sum(Feriado_Lunes) AS Feriados_Lunes, sum(Feriado_Otro) AS Feriados_Otro
FROM Dias_Especiales
GROUP BY ANO, MES")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.MES, TDF.GRAVEDAD, TDF.FREQ, Freq_lunes, Freq_martes, Freq_miercoles, Freq_jueves,Freq_viernes, Freq_sabado, Freq_domingo, Feriados, Feriados_Lunes, Feriados_Otro
FROM
(
SELECT
ANO, MES, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Mensuales DEM
ON (TDF.ANO=DEM.ANO AND TDF.MES=DEM.MES)
GROUP BY TDF.ANO, TDF.MES, TDF.GRAVEDAD")
View(Total_Dataset_Freq_M)
save(Total_Dataset_Freq_M,file="../data/Frecuencia_De_Accidentes_Mensual.Rda")
library(sqldf)
Dias_Especiales_Semanal <- sqldf("SELECT ANO, SEMANA, Feria_Flores_Semana,Semana_Santa_Semana, sum(Feriado_Lunes) as Feriados_Lunes, sum(Feriado_Otro) as Feriados_Otros
FROM Dias_Especiales
GROUP BY ANO,SEMANA,Feria_Flores_Semana,Semana_Santa_Semana")
library(sqldf)
Total_Dataset_Freq_M <- sqldf("
SELECT TDF.ANO, TDF.SEMANA, TDF.GRAVEDAD, TDF.FREQ, DES.Feria_Flores_Semana AS Feria_Flores, DES.Semana_Santa_Semana AS Semana_Santa, DES.Feriados_Lunes, DES.Feriados_Otros
FROM
(
SELECT
ANO, SEMANA, GRAVEDAD, sum(FREQ) as FREQ
FROM Total_Dataset_Freq
GROUP BY 1,2,3) TDF
LEFT JOIN Dias_Especiales_Semanal DES
ON (TDF.ANO=DES.ANO AND TDF.SEMANA=DES.SEMANA)
GROUP BY TDF.ANO, TDF.SEMANA, TDF.GRAVEDAD")
save(Total_Dataset_Freq_M,file="../data/Frecuencia_De_Accidentes_Semanal.Rda")
save(Total_Dataset_Freq_M,file="../data/Frecuencia_De_Accidentes_Semanal.Rda")
View(Dias_Especiales_Mensuales)
View(Dias_Especiales_Semanal)
save(Dias_Especiales_Mensuales,file="../data/Dias_Especiales_Mensuales.Rda")
save(Dias_Especiales_Semanal,file="../data/Dias_Especiales_Semanal.Rda")
save(Dias_Especiales_Semanal,file="../data/Dias_Especiales_Semanal.Rda")
